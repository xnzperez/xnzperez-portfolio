---
import ProjectCard from "../ui/ProjectCard.astro";
import { Icon } from "astro-icon/components";
import { getCollection } from "astro:content";

// Query featured projects from content collection
const allProjects = await getCollection("projects");
const featuredProjects = allProjects
  .filter((project) => project.data.featured)
  .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());

// Color gradients for project cards
const gradients = [
  "from-blue-900 to-slate-900",
  "from-purple-900 to-slate-900",
  "from-cyan-900 to-slate-900",
  "from-emerald-900 to-slate-900",
  "from-rose-900 to-slate-900",
];
---

<section id="projects" class="py-16 px-6 max-w-7xl mx-auto">
  <h2
    class="flex items-center justify-center gap-3 text-2xl md:text-3xl font-bold text-slate-100 mb-12"
  >
    <Icon name="mdi:code-tags" class="w-10 h-10 text-cyan-400" />
    Featured <span class="text-cyan-400">Projects</span>
  </h2>

  <div
    class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-7xl mx-auto"
  >
    {
      featuredProjects.map((project, index) => (
        <ProjectCard
          title={project.data.title}
          description={project.data.description}
          tags={project.data.tags}
          githubLink={project.data.githubLink}
          demoLink={project.data.demoLink}
          slug={project.slug}
        >
          <div
            slot="image"
            class={`w-full h-full bg-gradient-to-br ${gradients[index % gradients.length]} flex items-center justify-center text-white/20`}
          >
            <span class="text-4xl font-bold">
              {project.data.title
                .split(" ")
                .map((word) => word[0])
                .join("")
                .toUpperCase()
                .slice(0, 3)}
            </span>
          </div>
        </ProjectCard>
      ))
    }
  </div>
</section>
